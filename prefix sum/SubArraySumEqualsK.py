from typing import List


class Solution:
    def subarraySum(self, nums: List[int], k: int) -> int:
        n = len(nums)
        # prefix sum, two sums-ish
        prefix_sum = {0: 1}
        count = 0
        summ = 0

        for i in range(n):
            summ += nums[i]
            diff = summ - k
            # k = summ + diff
            count += prefix_sum.get(diff, 0)
            prefix_sum[summ] = prefix_sum.get(summ, 0) + 1

        return count

# Tests
sol = Solution()
# Testcase 1:
nums = [1,1,1]
k = 2
print(sol.subarraySum(nums, k) == 2)
# Testcase 2:
nums = [1,2,3]
k = 3
print(sol.subarraySum(nums, k) == 2)
# Testcase 3:
nums = [1,1,1]
k = 4
print(sol.subarraySum(nums, k) == 0)
# Testcase 4:
nums = [-1,-1,1]
k = -1
print(sol.subarraySum(nums, k) == 3)
# Testcase 5:
nums = [1,-1,0]
k = 0
print(sol.subarraySum(nums, k) == 3)
# Testcase 6:
nums = [-350,106,872,323,802,-227,109,952,161,-15,197,-134,-604,223,-151,852,978,959,-33,-240,-886,419,54,-222,837,550,646,471,-924,-781,-185,-205,573,173,-350,-331,352,-603,346,426,95,-812,198,-819,-69,461,-886,683,-421,-43,425,344,414,837,902,-679,783,-618,-288,221,779,-446,-316,654,149,504,894,645,-273,-56,-623,-180,-694,-712,884,28,-972,-32,-441,-744,206,-666,606,-701,483,727,-335,869,117,-124,317,886,781,198,-452,-403,-252,547,-729,246,970,714,822,-638,-176,-332,454,230,-343,-218,-784,-875,301,-183,-681,543,33,532,-20,-754,-735,359,-28,833,-408,-688,-122,-242,895,311,240,428,-666,652,39,340,-190,-728,-149,631,-872,-424,620,-853,52,209,911,253,300,-101,778,-237,806,74,285,-207,-91,-740,957,-523,-542,639,-58,222,922,-451,790,-622,-264,-148,315,837,481,903,914,-392,237,-555,669,-12,-291,-13,-888,699,567,711,632,-987,-668,426,862,-731,-59,905,683,-562,-220,821,281,-916,-839,938,227,-524,-843,603,-112,-128,924,876,277,-542,-263,-798,38,327,745,-812,823,538,-211,957,528,-405,-844,320,594,-352,-115,-459,309,256,-372,-182,-494,86,-918,32,872,-157,363,300,-34,-45,107,-432,-756,823,868,517,-506,761,369,286,-518,955,949,-843,-979,-14,743,-327,-430,-267,-961,-611,-956,593,-653,-174,-882,-616,115,642,483,245,684,670,933,154,-959,368,-145,-768,-491,-975,312,-197,-119,-63,-643,458,449,-52,164,187,831,-217,612,298,503,27,-585,863,-55,379,441,-679,-411,790,-842,342,949,272,-912,-808,-441,984,183,-676,-644,-494,-953,706,16,-364,320,-70,717,493,-986,-225,-341,18,-401,-566,-938,793,753,-676,442,878,-579,-332,850,717,-516,-903,-111,169,810,-561,968,-952,104,-557,530,903,375,-851,-559,-792,365,-110,-865,824,-83,435,480,-311,-424,-981,79,865,-667,-343,-832,-70,-889,785,64,453,-827,438,577,-505,752,434,692,224,-925,-363,-638,819,-333,903,-545,364,216,-356,-521,-482,313,-910,496,889,-650,-822,252,722,155,-578,226,-712,452,-21,736,-381,-274,843,696,-872,780,-304,-329,173,422,310,-977,162,-289,-134,111,792,659,979,-129,-532,-508,-892,384,984,-499,89,180,-305,716,0,981,-608,78,71,570,599,917,-996,912,-582,94,-725,555,426,-920,219,273,529,-776,457,237,778,-129,-296,-593,-636,980,419,546,947,-184,25,-931,42,-571,-831,-795,-419,758,-657,-281,679,535,178,684,-135,-179,-327,-970,948,640,-962,161,-428,-80,695,625,160,-725,474,-503,-643,-274,-905,808,-994,-88,861,246,-539,473,595,783,-492,-565,6,-698,866,179,-559,522,329,-11,144,905,-205,598,442,-248,-700,595,492,-145,-582,-462,986,102,747,447,885,680,538,-347,638,303,-226,407,938,337,415,397,532,857,-148,381,970,5,80,-988,769,549,496,-366,770,-48,-657,-495,-340,-19,-169,33,47,935,878,-551,582,262,-614,-972,452,-809,774,-824,565,-807,-228,656,-772,708,-803,-637,463,264,563,-925,-421,-500,-302,-576,-964,412,-484,-304,-112,656,-393,749,396,-261,-26,-557,154,-143,589,701,-784,900,329,728,253,721,-453,-315,549,-426,407,492,342,776,506,652,518,-851,-211,-328,841,-73,-936,-325,-448,120,404,402,-817,169,349,-436,-277,570,891,-558,305,-787,-329,-587,894,764,-222,-73,683,297,78,-496,161,-744,-325,286,-613,-11,762,562,-328,-178,762,726,6,-683,822,299,286,375,-180,702,823,164,279,581,219,453,-561,476,861,-503,-31,-480,-446,743,-924,-811,-224,268,412,830,-955,-610,816,-532,-103,73,-359,374,-128,-636,-732,-259,-3,760,-185,-99,497,912,-155,226,-230,-310,898,322,-260,455,-460,-522,-552,132,121,-382,-517,-950,-831,503,-340,924,134,-701,-741,-610,975,-872,-377,-366,-649,-607,-734,684,-662,-579,-353,-410,722,975,-955,-176,207,-152,-350,-975,991,-371,826,774,-984,-82,-710,-906,224,38,883,910,-937,643,118,-76,389,-32,284,85,-728,108,-8,-932,-466,23,660,373,-309,-895,-720,321,-996,991,108,-376,-26,589,984,-587,-215,515,-561,918,651,-216,-52,-574,-227,-56,40,-488,-381,-603,694,466,-46,-828,-285,150,992,-222,701,149,441,729,-166,566,-370,-394,152,318,-399,734,275,803,228,873,715,-495,-667,-767,-673,-66,-643,6,-486,-649,-816,300,313,-730,-399,-795,20,-347,-724,-315,183,-571,390,-948,891,93,-417,342,-320,-263,196,100,566,257,515,-415,856,853,-634,-80,-553,-343,6,950,295,957,69,-139,604,-741,-727,-16,-999,569,-439,-241,-131,107,-48,-7,-162,-457,682,-385,-463,-917,-700,-100,-77,953,252,91,98,107,-156,462,898,345,-52,-857,920,78,53,841,-233,46,-200,253,498,804,37,-96,-147,8,230,-486,231,-592,-872,-161,-390,-536,494,-290,-376,941,909,-937,-958,288,-896,370,36,375,765,752,312,140,-137,380,-988,80,641,-646,-851,-906,318,86,275,67,451,-176,-930,-857,-296,406,-619,329,57,-160,712,402,-920,746,68,-944,419,-407,-708,727,-260,521,-25,595,749,348,-538,-312,343,633,87,-716,-425,-310,-726,-730,304,-323,-768,-620,30,-686,837,951,282,709,105,-509,350,786,-399,-676,347,412,-309,-633,313,-593,-111,678,-803,646,217,691,-274,559,-245,-630,-784,-685,-679,281,-60,925,722,293,214,669,204,-462,-476,234,-960,-77,246,956,250,491,-37,-415,-238,926,21,-504,-174,744,926,187,-190,-847,473,413,-691,-868,-703,491,567,867,399,708,-279,313,749,-960,-292,474,407,521,-286,-726,-933,873,916,-838,-508,63,779,870,-4,441,-222,45,281,99,753,49,874,-367,295,77,-413,243,922,138,-255,510,823,-476,420,-740,-197,-372,-480,-642,-57,-725,-352,-911,-243,-545,179,678,-679,865,990,-188,-770,578,-277,-102,466,168,-865,-609,113,597,345,845,974,-917,-564,-252,860,-1,-913,183,452,-792,-297,-460,-466,-335,-209,322,898,968,245,-96,-189,810,-321,-319,843,-814,607,-639,-697,410,142,-635,507,800,-532,986,-998,21,-834,-672,612,663,-902,444,473,618,-3,-399,-189,-983,469,653,633,384,-926,293,-236,-769,421,55,-644,6,726,-981,832,168,623,-65,-489,55,116,898,221,-126,762,653,-871,297,-337,-467,415,854,-403,-460,155,-654,536,239,-218,-41,-323,795,-246,-58,618,-643,685,289,-296,536,87,367,925,-258,-747,-345,265,-951,437,189,401,-132,-550,-254,361,-755,-841,308,-110,284,-964,-126,-421,-416,583,-752,682,-232,-751,40,-405,-891,904,-241,376,-333,-640,-526,878,645,-425,684,-619,247,-340,792,-609,202,525,-352,716,377,-353,-674,13,548,646,-305,558,859,-360,-676,353,-591,365,370,114,256,-23,696,-482,627,-560,-82,199,-191,-686,-479,-22,755,134,-840,199,640,659,673,834,-290,462,363,952,880,691,-861,-165,910,-849,-380,769,468,-913,420,763,-810,-968,-523,-73,-387,480,-955,-889,-274,958,-836,-432,-502,602,721,819,-540,-417,754,-383,-127,-490,287,597,726,237,919,-205,161,987,370,751,-203,881,825,180,-335,-424,594,283,916,-418,410,-126,-904,-716,510,-504,-204,531,-753,128,-59,268,948,258,329,179,-223,971,-992,452,-191,-334,-13,-482,702,-691,-570,-609,495,333,268,108,-605,-925,-80,727,-978,508,872,-914,99,-590,-146,-19,-814,-317,-935,-229,-1000,-298,535,519,-154,-55,808,-156,841,-119,-589,-619,-634,-149,-385,947,-47,790,-867,770,995,539,903,-764,-377,-89,445,164,78,-487,-15,-218,944,484,913,684,-295,849,-975,-578,733,-58,158,246,-680,122,-468,556,-967,902,-933,724,849,-947,-876,-801,693,556,849,-331,-774,-243,2,-907,948,-864,-947,-74,710,-629,-374,497,-648,-445,853,384,966,533,837,24,314,-882,-843,662,167,8,121,-710,848,-480,-306,-97,-67,465,976,-598,663,-307,221,560,104,160,-875,-417,191,-944,553,-573,-41,-730,772,-518,-417,449,299,-958,16,786,-227,-779,-252,822,-62,8,-133,-640,-292,971,146,-384,-995,-505,906,755,-969,520,902,919,574,-761,-284,632,605,370,18,273,-203,-635,-253,427,-441,-467,-547,-141,743,-248,451,-936,481,-584,-679,321,-147,71,-507,608,-643,209,-823,-843,-536,-493,513,-310,858,-144,-416,162,733,202,-891,-74,-522,-425,-997,-74,-466,-546,-602,105,-805,-861,894,221,-721,-243,-458,747,-621,456,-372,430,-830,-679,414,794,871,-187,-730,248,632,472,-75,-647,996,662,-129,425,-519,-922,-532,25,961,-708,976,-4,-811,800,357,687,-610,-377,-504,603,312,-912,982,896,390,-311,-411,-532,518,37,207,494,547,-57,482,325,139,745,468,-124,514,353,977,-930,692,690,69,117,5,-990,-506,-685,-374,360,-77,463,932,548,868,-211,1,-379,-784,-574,984,-950,863,150,-251,-298,-589,-846,152,51,-40,204,468,354,499,-716,195,678,-48,602,-837,525,-387,-32,-929,-414,-137,-608,71,277,360,604,-931,517,-701,-261,293,246,750,127,-689,-57,-633,728,-734,-758,-88,188,-625,134,402,-970,226,302,-496,-381,-314,978,551,-248,-182,-29,861,-393,95,366,-502,-786,-34,305,-893,132,705,-177,-309,-680,-747,-226,920,995,-629,339,-248,491,-772,-200,809,127,658,-841,164,-288,-96,477,598,-944,-531,416,927,234,775,-178,-452,-119,-103,-871,118,-670,-337,320,659,-773,94,16,422,-278,814,499,-173,-653,-179,-386,-977,-576,239,361,14,139,725,703,-199,203,860,365,-490,900,-102,-332,-362,-527,-985,-678,-512,882,-207,153,480,548,-16,806,860,-893,944,-70,630,379,727,-244,-815,857,-377,-283,175,108,300,928,-304,951,565,-158,-801,845,718,359,231,823,-527,632,775,-497,516,615,-623,319,-489,238,234,-114,480,-209,383,180,998,698,843,-650,627,297,19,803,-1,-837,-48,734,790,-543,-3,-157,915,-81,178,-158,935,-520,-876,-439,986,-436,-677,167,562,461,776,929,-860,789,-56,759,912,-228,345,-696,612,-687,526,-599,-254,-53,-746,-849,-74,-572,-133,273,630,596,-173,-136,-455,-853,-382,-39,275,167,-725,-453,-974,-213,-952,103,474,438,470,96,-39,-367,-811,967,976,52]
k = 847
print(sol.subarraySum(nums, k) == 60)